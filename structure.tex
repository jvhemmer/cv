%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Wilson Resume/CV
% Structure specification file
% Version 1.1 (26/8/2024)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% Howard Wilson (https://github.com/watsonbox/cv_template_2004) with
% extensive modifications by Vel (vel@latextemplates.com) and later 
% Johann Hemmer (github.com/jvhemmer)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\usepackage[a4paper, hmargin=25mm, vmargin=30mm, top=20mm]{geometry} % Use A4 paper and set margins

\usepackage{fancyhdr} % Customize the header and footer

\usepackage{lastpage} % Required for calculating the number of pages in the document

\usepackage{xparse}

\usepackage[hidelinks]{hyperref} % Colors for links, text and headings

%\usepackage[proportional,scaled=1.064]{erewhon} % Use the Erewhon font
%\usepackage[erewhon,vvarbb,bigdelims]{newtxmath} % Use the Erewhon font
\usepackage[utf8]{inputenc} % Required for inputting international characters
\usepackage[T1]{fontenc} % Output font encoding for international characters

\usepackage{fontspec} % Required for specification of custom fonts
\setmainfont[Path = ./fonts/,
Extension = .otf,
BoldFont = Erewhon-Bold,
ItalicFont = Erewhon-Italic,
BoldItalicFont = Erewhon-BoldItalic,
SmallCapsFeatures = {Letters = SmallCaps}
]{Erewhon-Regular}

\usepackage[table]{xcolor} % Required for custom colors. The table argument enables colors in tables

\usepackage[portuguese]{babel} % Support for languages

\usepackage{setspace}

\usepackage{amsmath} % Math

\usepackage{tabularx} % Tables with more options

% Define colors used in the document
\definecolor{slateblue}{rgb}{0.17,0.22,0.34} % Sections, etc.
\colorlet{lightblue}{slateblue!5} % Year columns

\usepackage{etoolbox}
\usepackage{everyshi}

\usepackage[explicit]{titlesec} % Customization of titles

% Definition of the section title style
\newcommand{\raisedrulefill}[2][0ex]{\leaders\hbox{\rule[#1]{5pt}{#2}}\hfill}
\titleformat{\section}
    {\Large\bfseries} % size and weight
    {} % no number
    {0em}
    {\color{slateblue}\storesectiontitle{#1}#1 \,\raisedrulefill[0.4ex]{1pt}}

% Logic for repeating the section title and adding "(continued)" when a section goes to the next page
\newcommand{\storesectiontitle}[1]{% store the title of the current section
  \gdef\currentsectiontitle{#1}%
}

\newcommand{\displaysectiontitle}{% display the title of the current section
  \noindent\textcolor{slateblue}{\Large\bfseries\currentsectiontitle}%
}

% Page style
\fancypagestyle{full}{
\fancyhf{}
% \fancyfoot[LE,LO]{Johann V. Hemmer, M.S.}
\fancyfoot[RE,RO]{\hrule Johann V. Hemmer, M.S. \colorbox{slateblue!30}{{\thepage\,\,of\,\,\pageref{LastPage}}}}
}

\renewcommand{\headrulewidth}{0pt} % Disable the default header rule
\renewcommand{\footrulewidth}{0pt} % Disable the default footer rule

\pagestyle{full}

\EveryShipout{%
  \ifdim\pagetotal>\pagegoal% There is content overflow on this page
    \AddToHookNext{shipout/after}{\displaysectiontitle\, (continued)\par\bigskip}
  \fi%
}

\setlength\parindent{0pt} % Stop paragraph indentation

% Non-indenting itemize
\newenvironment{itemize-noindent}
{\setlength{\leftmargini}{0em}\begin{itemize}}
{\end{itemize}}

% Text width for tabbing environments
\newlength{\smallertextwidth}
\setlength{\smallertextwidth}{\textwidth}
\addtolength{\smallertextwidth}{-2cm}

\newcommand{\sqbullet}{~\vrule height 1ex width .8ex depth -.2ex} % Custom square bullet poin

% Superscript
\newcommand{\pow}[1]{$^{#1}$}
\newcommand{\powt}[1]{$^{\text{#1}}$}

% subscript
\newcommand{\sub}[1]{$_{#1}$}
\newcommand{\subt}[1]{$_{\text{#1}}$}

%----------------------------------------------------------------------------------------
%	MAIN HEADER COMMAND
%----------------------------------------------------------------------------------------

\renewcommand{\title}[2]{
{\huge{\color{slateblue}\textbf{#1}}} \hspace{.5cm} #2\\ % Header section name and color
% \rule{\textwidth}{0.5mm}\\ % Rule under the header
}

%----------------------------------------------------------------------------------------
%	JOB COMMAND
%----------------------------------------------------------------------------------------

\newcommand{\job}[6]{
\begin{tabbing}
\hspace{2cm} \= \kill
\textbf{#1} \> \href{#4}{#3} \\
\textbf{#2} \>\+ \textit{#5} \\
\begin{minipage}{\smallertextwidth}
\vspace{2mm}
#6
\end{minipage}
\end{tabbing}
\vspace{2mm}
}

%----------------------------------------------------------------------------------------
%	PUBLICATION COMMAND
%----------------------------------------------------------------------------------------

% \newcommand{\publication}[5]{
% \begin{tabbing}
% \hspace{2cm} \= \kill
% \textbf{#1} \> #2 \\
% \textbf{} \>\+ \textit{#3} \\
% \begin{minipage}{\smallertextwidth}
% \href{#5}{#4}
% \end{minipage}
% \end{tabbing}
% \vspace{2mm}
% }

%----------------------------------------------------------------------------------------
%	SKILL GROUP COMMAND
%----------------------------------------------------------------------------------------

\newcommand{\skillgroup}[2]{
\begin{tabbing}
\hspace{5mm} \= \kill
\sqbullet \>\+ \textbf{#1} \\
\begin{minipage}{\smallertextwidth}
\vspace{2mm}
#2
\end{minipage}
\end{tabbing}
}

%----------------------------------------------------------------------------------------
%	INTERESTS GROUP COMMAND
%-----------------------------------------------------------------------------------------

\newcommand{\interestsgroup}[1]{
\begin{tabbing}
\hspace{5mm} \= \kill
#1
\end{tabbing}
\vspace{-10mm}
}

\newcommand{\interest}[1]{\sqbullet \> \textbf{#1}\\[3pt]} % Define a custom command for individual interests

%----------------------------------------------------------------------------------------
%	AWARDS GROUP COMMAND
%-----------------------------------------------------------------------------------------

\newcommand{\awardsgroup}[1]{
\begin{tabbing}
\hspace{.25cm} \= \hspace{1cm} \= \hspace{1cm} \= \kill
#1
\end{tabbing}
\vspace{-10mm}
}

\newcommand{\award}[2]{\sqbullet \> \textbf{#1} \> #2 \\[3pt]} % Define a custom command for individual interests

%----------------------------------------------------------------------------------------
%	TABBED BLOCK COMMAND
%----------------------------------------------------------------------------------------

\newcommand{\tabbedblock}[1]{
\begin{tabbing}
\hspace{2cm} \= \hspace{4cm} \= \kill
#1
\end{tabbing}
}

%----------------------------------------------------------------------------------------
%	TIMELINE TABLE COMMAND
%----------------------------------------------------------------------------------------

% Container environment
% Arguments:
%   1: (mandatory)  Company/institution name
%   2: (optional)   Company/institution URL

\newcounter{entrycount} % counter to know if the entry is the first or not

\NewDocumentEnvironment{timeline}{m O{}}{%

    \setcounter{entrycount}{0}  % reset counter for each new env
    
    \tabularx{\textwidth}{>{\columncolor{lightblue}}p{1.8cm}X}
        & \textbf{%
            \IfNoValueT{#2}% Check if URL was provided (argument 2)
                {#1}% no URL
                {\href{#2}{#1}}% URL
        }\vspace{0.1cm} \\
}{
    \endtabularx
}

% Command for each semester and course entry
% Arguments:
%   1: (mandatory, can be empty)    Semester/year
%   2: (mandatory)                  Course name
%   3: (mandatory)                  Instructor name

\NewDocumentCommand{\entry}{m m m}{% MUST BE INSIDE TIMELINE ENVIRONMENT!!!

    % check if counter is greater than zero. In that case, add a space before the next row
    \ifnum\value{entrycount}>0 
        \\
    \fi
    
    \stepcounter{entrycount} % increment    
    
    \centering\textbf{#1} & \textit{#2} \\
    & Instructor: #3 
}